# Case 1 â€” Social Feed (Following Feed)
# Local development defaults (docker-compose will override as needed).

# PostgreSQL (authoritative stores)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=case1_feed
POSTGRES_PASSWORD=case1_feed
POSTGRES_DB=case1_feed

# Redis (derived feed hot window)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_CONNECT_TIMEOUT_MS=200
REDIS_SYNC_TIMEOUT_MS=500
REDIS_ASYNC_TIMEOUT_MS=500
REDIS_RETRY_MAX_ATTEMPTS=3
REDIS_RETRY_INITIAL_DELAY_MS=200
REDIS_RETRY_MAX_DELAY_MS=2000

# Kafka / Redpanda (event bus)
KAFKA_BROKERS=localhost:9092
KAFKA_CLIENT_ID=case1-feed
KAFKA_SECURITY_PROTOCOL=PLAINTEXT
KAFKA_TOPIC_POST_CREATED=post.created.v1
KAFKA_POLL_TIMEOUT_MS=1000
KAFKA_PRODUCE_TIMEOUT_MS=2000
KAFKA_RETRY_MAX_ATTEMPTS=3
KAFKA_RETRY_INITIAL_DELAY_MS=200
KAFKA_RETRY_MAX_DELAY_MS=2000
KAFKA_CIRCUIT_BREAKER_FAILURE_THRESHOLD=4
KAFKA_CIRCUIT_BREAKER_OPEN_SECONDS=15

# Database resilience
DB_COMMAND_TIMEOUT_SECONDS=2
DB_RETRY_MAX_ATTEMPTS=3
DB_RETRY_INITIAL_DELAY_MS=200
DB_RETRY_MAX_DELAY_MS=2000
DB_CIRCUIT_BREAKER_FAILURE_THRESHOLD=4
DB_CIRCUIT_BREAKER_OPEN_SECONDS=15

# Feed Service resilience (HTTP + circuit breakers)
GRAPH_HTTP_TIMEOUT_MS=1500
POST_HTTP_TIMEOUT_MS=1500
GRAPH_RETRY_MAX_ATTEMPTS=3
GRAPH_RETRY_INITIAL_DELAY_MS=200
GRAPH_RETRY_MAX_DELAY_MS=2000
POST_RETRY_MAX_ATTEMPTS=3
POST_RETRY_INITIAL_DELAY_MS=200
POST_RETRY_MAX_DELAY_MS=2000
GRAPH_CIRCUIT_BREAKER_FAILURE_THRESHOLD=4
GRAPH_CIRCUIT_BREAKER_OPEN_SECONDS=15
POST_CIRCUIT_BREAKER_FAILURE_THRESHOLD=4
POST_CIRCUIT_BREAKER_OPEN_SECONDS=15

# Fanout backpressure
FANOUT_MAX_CONCURRENT_EVENTS=4
FANOUT_MAX_CONCURRENT_REDIS_WRITES=16
FANOUT_FOLLOWERS_PER_SECOND=2000
FANOUT_REDIS_WRITES_PER_SECOND=2000
FANOUT_KAFKA_LAG_THRESHOLD=5000
FANOUT_KAFKA_LAG_CHECK_INTERVAL_MS=5000
FANOUT_KAFKA_LAG_PAUSE_MS=2000

# OpenTelemetry
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_EXPORTER_OTLP_PROTOCOL=grpc
OTEL_SERVICE_NAME=case1-feed
OTEL_RESOURCE_ATTRIBUTES=service.namespace=case1,service.version=0.1.0

# Observability (optional local defaults)
PROMETHEUS_URL=http://localhost:9090
GRAFANA_URL=http://localhost:3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=admin
